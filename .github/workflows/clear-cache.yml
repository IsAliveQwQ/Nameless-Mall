# =================================================================
# == Nameless Mall - Actions Cache Cleaner
# == è·è²¬ï¼šæ¸…é™¤ GitHub Actions æ®˜ç•™å¿«å–ï¼Œé‡‹æ”¾å„²å­˜ç©ºé–“
# == æ¥­ç•Œæ¨™æº–ï¼šå®šæœŸæ‰‹å·¥æ¸…ç†ï¼Œé˜²æ­¢ Maven æˆ– Docker å¿«å–è†¨è„¹
# =================================================================

name: Clear Actions Cache

on:
  workflow_dispatch: # å…è¨±æ‰‹å‹•å¾ Actions é é¢è§¸ç™¼

permissions:
  actions: write # å¿…é ˆæ“æœ‰å¯«å…¥æ¬Šé™æ‰èƒ½åˆªé™¤å¿«å–

jobs:
  clear-cache:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Delete all caches
        shell: bash
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "ğŸš€ Detecting caches for repository..."
          
          # ç²å–æ‰€æœ‰å¿«å–çš„æ¸…å–®
          gh cache list --limit 100
          
          echo "ğŸ§¹ Starting batch deletion of all caches..."
          
          # ä½¿ç”¨ GitHub CLI æ‰¹æ¬¡åˆªé™¤å…¨éƒ¨å¿«å–
          gh cache delete --all
          
          echo "âœ… Cache cleanup completed!"
